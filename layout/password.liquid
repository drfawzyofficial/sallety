<!doctype html>
<html class="no-js" lang="{{ request.locale.iso_code }}" dir="{% if settings.enable_rtl %}rtl{% else %}ltr{% endif %}">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <meta name="theme-color" content="{{ settings.color_schemes['scheme-1'].settings.button }}">

    <link rel="preconnect" href="https://cdn.shopify.com" crossorigin>

    {%- if settings.font_source == 'google' -%}
      {%- comment -%} Google Fonts Preconnect {%- endcomment -%}
      <link rel="preconnect" href="https://fonts.googleapis.com">
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
      {%- liquid
        assign heading_font = settings.google_font_heading | default: 'Tajawal'
        assign body_font = settings.google_font_body | default: 'Tajawal'
        assign all_weights = '400;500;700;800'
      -%}
      
      <link href="https://fonts.googleapis.com/css2?family={{ heading_font | replace: ' ', '+' }}:wght@{{ all_weights }}{% if heading_font != body_font %}&family={{ body_font | replace: ' ', '+' }}:wght@{{ all_weights }}{% endif %}&display=swap" rel="stylesheet">
    {%- else -%}
      <link rel="preconnect" href="https://fonts.shopifycdn.com" crossorigin>
    {%- endif -%}

    {%- if settings.favicon != blank -%}
      <link rel="icon" type="image/png" href="{{ settings.favicon | image_url: width: 32, height: 32 }}">
    {%- endif -%}

    <title>{{ shop.name }}</title>

    {%- if page_description -%}
      <meta name="description" content="{{ page_description | escape }}">
    {%- endif -%}

    {{ content_for_header }}

    {%- liquid
      if settings.font_source == 'shopify'
        assign body_font_bold = settings.body_font | font_modify: 'weight', 'bold'
        assign body_font_italic = settings.body_font | font_modify: 'style', 'italic'
        assign body_font_bold_italic = body_font_bold | font_modify: 'style', 'italic'
      endif
    %}

    {%- comment -%} TailwindCSS V4 CDN {%- endcomment -%}
    {%- comment -%} TailwindCSS V4 CDN - Cannot use defer as config script requires immediate access {%- endcomment -%}
    <script src="https://cdn.tailwindcss.com?plugins=forms"></script>
    <script>
      tailwind.config = {
        darkMode: 'class',
        theme: {
          extend: {
            colors: {
              primary: 'var(--color-primary)',
              secondary: 'var(--color-secondary)',
              accent: 'var(--color-accent)',
              background: 'var(--color-background)',
              foreground: 'var(--color-foreground)',
              border: 'var(--color-border)',
              success: 'var(--color-success)',
              warning: 'var(--color-warning)',
              error: 'var(--color-error)',
              'btn-primary': 'var(--button-primary-bg)',
              'btn-primary-text': 'var(--button-primary-text)',
            },
            fontFamily: {
              body: 'var(--font-body-family)',
              heading: 'var(--font-heading-family)',
            },
            borderRadius: {
              'btn': 'var(--button-border-radius)',
              'sm': 'var(--border-radius-small)',
              'md': 'var(--border-radius-medium)',
              'lg': 'var(--border-radius-large)',
            },
          }
        },
        corePlugins: {
          preflight: false,
        }
      }
    </script>

    {% style %}
      {%- if settings.font_source == 'shopify' -%}
        {{ settings.body_font | font_face: font_display: 'swap' }}
        {{ body_font_bold | font_face: font_display: 'swap' }}
        {{ body_font_italic | font_face: font_display: 'swap' }}
        {{ body_font_bold_italic | font_face: font_display: 'swap' }}
        {{ settings.heading_font | font_face: font_display: 'swap' }}
      {%- endif -%}

      :root {
        /* Native Color Schemes - Generated from settings.color_schemes */
        {%- for scheme in settings.color_schemes -%}
          {%- assign scheme_id = scheme[0] -%}
          {%- assign scheme_settings = scheme[1].settings -%}
          --{{ scheme_id }}-background: {{ scheme_settings.background }};
          --{{ scheme_id }}-text: {{ scheme_settings.text }};
          --{{ scheme_id }}-secondary-text: {{ scheme_settings.secondary_text }};
          --{{ scheme_id }}-button: {{ scheme_settings.button }};
          --{{ scheme_id }}-button-label: {{ scheme_settings.button_label }};
          --{{ scheme_id }}-accent: {{ scheme_settings.accent }};
          --{{ scheme_id }}-border: {{ scheme_settings.border }};
          --{{ scheme_id }}-card-bg: {{ scheme_settings.card_background }};
          --{{ scheme_id }}-card-text: {{ scheme_settings.card_text }};
        {%- endfor -%}

        /* Default colors (Scheme 1) */
        {%- assign default_scheme = settings.color_schemes['scheme-1'].settings -%}
        --color-background: {{ default_scheme.background }};
        --color-foreground: {{ default_scheme.text }};
        --color-primary: {{ default_scheme.button }};
        --color-secondary: {{ default_scheme.secondary_text }};
        --color-accent: {{ default_scheme.accent }};
        --color-border: {{ default_scheme.border }};

        /* Status Colors */
        --color-success: {{ settings.color_success }};
        --color-warning: {{ settings.color_warning }};
        --color-error: {{ settings.color_error }};

        /* Button Settings - Primary */
        --button-primary-bg: {{ settings.button_primary_bg }};
        --button-primary-text: {{ settings.button_primary_text }};
        --button-primary-bg-hover: {{ settings.button_primary_bg_hover }};
        --button-primary-text-hover: {{ settings.button_primary_text_hover }};

        /* Button Settings - Secondary */
        --button-secondary-bg: {{ settings.button_secondary_bg }};
        --button-secondary-text: {{ settings.button_secondary_text }};
        --button-secondary-border: {{ settings.button_secondary_border }};
        --button-secondary-bg-hover: {{ settings.button_secondary_bg_hover }};
        --button-secondary-text-hover: {{ settings.button_secondary_text_hover }};

        /* Button Border & Radius */
        --button-border-thickness: {{ settings.button_border_thickness }}px;
        --button-border-opacity: {{ settings.button_border_opacity | divided_by: 100.0 }};
        --button-border-radius: {{ settings.button_radius }}px;

        /* Button Typography */
        --button-font-weight: {{ settings.button_font_weight }};
        --button-text-transform: {{ settings.button_text_transform }};

        /* Button Spacing */
        --button-padding-vertical: {{ settings.button_padding_vertical }}px;
        --button-padding-horizontal: {{ settings.button_padding_horizontal }}px;

        /* Button Transitions */
        --button-transition-duration: {{ settings.button_transition_duration }}ms;

        /* Input Settings - Colors */
        --input-bg: {{ settings.input_bg }};
        --input-text: {{ settings.input_text }};
        --input-placeholder: {{ settings.input_placeholder }};

        /* Input Settings - Border */
        --input-border: {{ settings.input_border }};
        --input-border-thickness: {{ settings.input_border_thickness }}px;
        --input-border-radius: {{ settings.input_border_radius }}px;

        /* Input Settings - Focus */
        --input-focus-border: {{ settings.input_focus_border }};
        --input-focus-shadow: {{ settings.input_focus_shadow }};
        --input-focus-shadow-opacity: {{ settings.input_focus_shadow_opacity | divided_by: 100.0 }};

        /* Input Settings - Spacing */
        --input-padding-vertical: {{ settings.input_padding_vertical }}px;
        --input-padding-horizontal: {{ settings.input_padding_horizontal }}px;

        /* Input Settings - States */
        --input-error-border: {{ settings.input_error_border }};

        /* Typography - Font Families */
        {%- if settings.font_source == 'google' -%}
          --font-body-family: '{{ settings.google_font_body | default: 'Tajawal' }}', sans-serif;
          --font-body-style: normal;
          --font-body-weight: {{ settings.google_font_body_weight | default: '400' }};

          --font-heading-family: '{{ settings.google_font_heading | default: 'Tajawal' }}', sans-serif;
          --font-heading-style: normal;
          --font-heading-weight: {{ settings.google_font_heading_weight | default: '700' }};
        {%- else -%}
          --font-body-family: {{ settings.body_font.family }}, {{ settings.body_font.fallback_families }};
          --font-body-style: {{ settings.body_font.style }};
          --font-body-weight: {{ settings.body_font.weight }};

          --font-heading-family: {{ settings.heading_font.family }}, {{ settings.heading_font.fallback_families }};
          --font-heading-style: {{ settings.heading_font.style }};
          --font-heading-weight: {{ settings.heading_font.weight }};
        {%- endif -%}

        /* Heading Font Sizes - Desktop */
        --h1-font-size: {{ settings.h1_font_size_desktop | default: 48 }}px;
        --h2-font-size: {{ settings.h2_font_size_desktop | default: 36 }}px;
        --h3-font-size: {{ settings.h3_font_size_desktop | default: 28 }}px;
        --h4-font-size: {{ settings.h4_font_size_desktop | default: 24 }}px;
        --h5-font-size: {{ settings.h5_font_size_desktop | default: 20 }}px;
        --h6-font-size: {{ settings.h6_font_size_desktop | default: 18 }}px;

        /* Heading Font Sizes - Tablet */
        --h1-font-size-tablet: {{ settings.h1_font_size_tablet | default: 40 }}px;
        --h2-font-size-tablet: {{ settings.h2_font_size_tablet | default: 30 }}px;
        --h3-font-size-tablet: {{ settings.h3_font_size_tablet | default: 24 }}px;
        --h4-font-size-tablet: {{ settings.h4_font_size_tablet | default: 20 }}px;
        --h5-font-size-tablet: {{ settings.h5_font_size_tablet | default: 18 }}px;
        --h6-font-size-tablet: {{ settings.h6_font_size_tablet | default: 16 }}px;

        /* Heading Font Sizes - Mobile */
        --h1-font-size-mobile: {{ settings.h1_font_size_mobile | default: 32 }}px;
        --h2-font-size-mobile: {{ settings.h2_font_size_mobile | default: 26 }}px;
        --h3-font-size-mobile: {{ settings.h3_font_size_mobile | default: 22 }}px;
        --h4-font-size-mobile: {{ settings.h4_font_size_mobile | default: 18 }}px;
        --h5-font-size-mobile: {{ settings.h5_font_size_mobile | default: 16 }}px;
        --h6-font-size-mobile: {{ settings.h6_font_size_mobile | default: 14 }}px;

        /* Legacy fallback - for backward compatibility with existing sections */
        --font-heading-size: var(--h2-font-size);
        --font-heading-size-tablet: var(--h2-font-size-tablet);
        --font-heading-size-mobile: var(--h2-font-size-mobile);

        /* Body Font Sizes - Desktop */
        --font-body-size: {{ settings.body_font_size_desktop | default: 18 }}px;
        
        /* Body Font Sizes - Tablet */
        --font-body-size-tablet: {{ settings.body_font_size_tablet | default: 16 }}px;
        
        /* Body Font Sizes - Mobile */
        --font-body-size-mobile: {{ settings.body_font_size_mobile | default: 14 }}px;

        /* Line Height */
        --line-height: {{ settings.line_height | default: 160 }}%;

        /* Layout */
        --page-width: {{ settings.page_width }}px;
        --container-padding: {{ settings.container_padding }}px;
        --section-spacing: {{ settings.section_spacing }}px;
        --grid-gap: {{ settings.grid_gap }}px;

        /* Border Radius */
        --border-radius-small: {{ settings.border_radius_small }}px;
        --border-radius-medium: {{ settings.border_radius_medium }}px;
        --border-radius-large: {{ settings.border_radius_large }}px;

        /* Transitions */
        --transition-duration: {{ settings.transition_duration }}ms;
        --transition-timing: ease-in-out;
      }
    {% endstyle %}

    {{ 'base.css' | asset_url | stylesheet_tag }}

    <style>
      /* Password Page Base Styles */
      *,
      *::before,
      *::after {
        box-sizing: border-box;
      }

      * {
        margin: 0;
        padding: 0;
      }

      html {
        scroll-behavior: smooth;
      }

      body {
        font-family: var(--font-body-family);
        font-style: var(--font-body-style);
        font-weight: var(--font-body-weight);
        line-height: var(--line-height);
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      h1, h2, h3, h4, h5, h6 {
        font-family: var(--font-heading-family);
        font-style: var(--font-heading-style);
        font-weight: var(--font-heading-weight);
        line-height: 1.2;
      }

      img,
      picture,
      video,
      canvas,
      svg {
        display: block;
        max-width: 100%;
      }

      a {
        color: inherit;
        text-decoration: none;
      }

      button {
        cursor: pointer;
        background: none;
        border: none;
      }

      /* ================================
         INPUT STYLES - Connected to Global Settings
         ================================ */
      input[type="text"],
      input[type="email"],
      input[type="password"],
      input[type="tel"],
      input[type="number"],
      input[type="search"],
      input[type="url"],
      textarea,
      select {
        font: inherit;
        width: 100%;
        background-color: var(--input-bg);
        color: var(--input-text);
        border: var(--input-border-thickness) solid var(--input-border);
        border-radius: var(--input-border-radius);
        padding: var(--input-padding-vertical) var(--input-padding-horizontal);
        transition: border-color var(--transition-duration) var(--transition-timing),
                    box-shadow var(--transition-duration) var(--transition-timing);
        outline: none;
      }

      input[type="text"]::placeholder,
      input[type="email"]::placeholder,
      input[type="password"]::placeholder,
      input[type="tel"]::placeholder,
      input[type="number"]::placeholder,
      input[type="search"]::placeholder,
      input[type="url"]::placeholder,
      textarea::placeholder {
        color: var(--input-placeholder);
        opacity: 1;
      }

      /* Input Focus State */
      input[type="text"]:focus,
      input[type="email"]:focus,
      input[type="password"]:focus,
      input[type="tel"]:focus,
      input[type="number"]:focus,
      input[type="search"]:focus,
      input[type="url"]:focus,
      textarea:focus,
      select:focus {
        border-color: var(--input-focus-border);
        box-shadow: 0 0 0 3px color-mix(in srgb, var(--input-focus-shadow) calc(var(--input-focus-shadow-opacity) * 100%), transparent);
      }

      /* Fallback for browsers that don't support color-mix */
      @supports not (color: color-mix(in srgb, red, blue)) {
        input[type="text"]:focus,
        input[type="email"]:focus,
        input[type="password"]:focus,
        input[type="tel"]:focus,
        input[type="number"]:focus,
        input[type="search"]:focus,
        input[type="url"]:focus,
        textarea:focus,
        select:focus {
          box-shadow: 0 0 0 3px rgba(26, 39, 68, 0.1);
        }
      }

      /* Input Error State */
      input.input-error,
      input[aria-invalid="true"],
      textarea.input-error,
      textarea[aria-invalid="true"],
      select.input-error,
      select[aria-invalid="true"] {
        border-color: var(--input-error-border);
      }

      input.input-error:focus,
      input[aria-invalid="true"]:focus,
      textarea.input-error:focus,
      textarea[aria-invalid="true"]:focus {
        border-color: var(--input-error-border);
        box-shadow: 0 0 0 3px rgba(220, 53, 69, 0.15);
      }

      /* Input Disabled State */
      input:disabled,
      textarea:disabled,
      select:disabled {
        background-color: var(--input-disabled-bg, #f3f4f6);
        opacity: var(--input-disabled-opacity, 0.6);
        cursor: not-allowed;
      }

      /* Select Dropdown */
      select {
        appearance: none;
        -webkit-appearance: none;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%236b7280' d='M6 8.5L1.5 4h9L6 8.5z'/%3E%3C/svg%3E");
        background-repeat: no-repeat;
        background-position: left 12px center;
        padding-left: 36px;
      }

      [dir="ltr"] select {
        background-position: right 12px center;
        padding-left: var(--input-padding-horizontal);
        padding-right: 36px;
      }

      /* Checkbox and Radio - Custom Styling */
      input[type="checkbox"],
      input[type="radio"] {
        width: 18px;
        height: 18px;
        accent-color: var(--color-primary);
        cursor: pointer;
      }

      /* Button Styles - Connected to Global Settings */
      button,
      .button,
      input[type="submit"],
      input[type="button"] {
        font: inherit;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        padding: var(--button-padding-vertical) var(--button-padding-horizontal);
        border-radius: var(--button-border-radius);
        font-weight: var(--button-font-weight);
        text-transform: var(--button-text-transform);
        transition: all var(--button-transition-duration) var(--transition-timing);
        cursor: pointer;
        border: none;
      }

      /* Primary Button */
      .button--primary,
      input[type="submit"] {
        background-color: var(--button-primary-bg);
        color: var(--button-primary-text);
        border: var(--button-border-thickness) solid var(--button-primary-bg);
      }

      .button--primary:hover,
      input[type="submit"]:hover {
        background-color: var(--button-primary-bg-hover);
        color: var(--button-primary-text-hover);
        border-color: var(--button-primary-bg-hover);
      }

      /* Secondary Button */
      .button--secondary {
        background-color: var(--button-secondary-bg);
        color: var(--button-secondary-text);
        border: var(--button-border-thickness) solid var(--button-secondary-border);
      }

      .button--secondary:hover {
        background-color: var(--button-secondary-bg-hover);
        color: var(--button-secondary-text-hover);
      }

      /* Form Error Messages */
      .form-error,
      .form__errors {
        color: var(--input-error-border);
        font-size: 0.875rem;
        margin-top: 0.5rem;
      }

      /* Form Labels */
      label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: 500;
        color: var(--color-foreground);
      }

      /* Form Field Wrapper */
      .form-field {
        margin-bottom: 1rem;
      }

      .skip-to-content-link {
        position: absolute;
        top: -100%;
        left: 0;
        padding: 12px 24px;
        background: var(--color-primary);
        color: var(--button-primary-text);
        z-index: 9999;
        transition: top 0.3s ease;
      }

      .skip-to-content-link:focus {
        top: 0;
      }

      .visually-hidden {
        position: absolute !important;
        overflow: hidden;
        width: 1px;
        height: 1px;
        margin: -1px;
        padding: 0;
        border: 0;
        clip: rect(0 0 0 0);
        word-wrap: normal !important;
      }
    </style>

    <script>
      document.documentElement.className = document.documentElement.className.replace('no-js', 'js');
    </script>
  </head>

  <body class="template-password">
    <a class="skip-to-content-link button visually-hidden" href="#MainContent">
      {{ 'accessibility.skip_to_content' | t }}
    </a>

    <main id="MainContent" class="password-main" role="main" tabindex="-1">
      {{ content_for_layout }}
    </main>

    <script src="{{ 'theme.js' | asset_url }}" defer></script>
  </body>
</html>
