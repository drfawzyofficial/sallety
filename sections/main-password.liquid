{%- comment -%}
  Sallety Theme - Main Password Section
  Full-page password/coming soon page with modern design
  RTL layout with Arabic labels - Following Sallety Theme Patterns
{%- endcomment -%}

{%- liquid
  # Color scheme class (uses CSS classes from theme.liquid)
  assign scheme_number = section.settings.color_scheme.id | remove: 'scheme-'

  # Typography - Responsive sizes
  assign heading_size_desktop = section.settings.heading_size_desktop | default: 48
  assign heading_size_tablet = section.settings.heading_size_tablet | default: 40
  assign heading_size_mobile = section.settings.heading_size_mobile | default: 32
  assign body_size_desktop = section.settings.body_size_desktop | default: 18
  assign body_size_tablet = section.settings.body_size_tablet | default: 16
  assign body_size_mobile = section.settings.body_size_mobile | default: 14

  # Typography - Weights
  assign heading_weight = section.settings.heading_weight | default: '700'
  assign body_weight = section.settings.body_weight | default: '400'

  # Section settings - Use global logo from theme settings
  assign logo = settings.logo
  assign logo_width = settings.logo_width | default: 150
  assign heading = section.settings.heading
  assign description = section.settings.description
  assign heading_alignment = section.settings.heading_alignment | default: 'center'
  assign show_countdown = section.settings.show_countdown
  assign countdown_date = section.settings.countdown_date
  assign show_newsletter = section.settings.show_newsletter
  assign newsletter_heading = section.settings.newsletter_heading
  assign newsletter_placeholder = section.settings.newsletter_placeholder
  assign newsletter_button_text = section.settings.newsletter_button_text
  assign show_social = section.settings.show_social
  assign show_shapes = section.settings.show_shapes
  assign show_login_link = section.settings.show_login_link

  # Background settings
  assign background_image = section.settings.background_image
  assign background_overlay_opacity = section.settings.background_overlay_opacity | default: 50

  # Padding settings
  assign padding_top = section.settings.padding_top | default: 60
  assign padding_bottom = section.settings.padding_bottom | default: 60
-%}

{%- capture section_dir -%}{%- render 'section-dir' -%}{%- endcapture -%}
<section
  class="password-section color-scheme-{{ scheme_number }} relative min-h-screen flex items-center justify-center overflow-hidden"
  dir="{{ section_dir }}"
  data-section-id="{{ section.id }}"
  data-section-type="password"
  style="
    --password-heading-desktop: {{ heading_size_desktop }}px;
    --password-heading-tablet: {{ heading_size_tablet }}px;
    --password-heading-mobile: {{ heading_size_mobile }}px;
    --password-body-desktop: {{ body_size_desktop }}px;
    --password-body-tablet: {{ body_size_tablet }}px;
    --password-body-mobile: {{ body_size_mobile }}px;
    --password-heading-weight: {{ heading_weight }};
    --password-body-weight: {{ body_weight }};
    --password-overlay-opacity: {{ background_overlay_opacity | divided_by: 100.0 }};
    padding-top: {{ padding_top }}px;
    padding-bottom: {{ padding_bottom }}px;
    font-family: var(--font-body-family);
  "
>
  <!-- Background Image -->
  {%- if background_image != blank -%}
    <div class="password-background absolute inset-0 z-0">
      <img
        src="{{ background_image | image_url: width: 1920 }}"
        srcset="
          {{ background_image | image_url: width: 768 }} 768w,
          {{ background_image | image_url: width: 1200 }} 1200w,
          {{ background_image | image_url: width: 1920 }} 1920w
        "
        sizes="100vw"
        alt="{{ heading | default: shop.name }}"
        class="w-full h-full object-cover"
        loading="eager"
        width="{{ background_image.width }}"
        height="{{ background_image.height }}"
      >
      <div
        class="password-overlay absolute inset-0"
        style="background: rgba(0, 0, 0, var(--password-overlay-opacity));"
      ></div>
    </div>
  {%- endif -%}

  <!-- Decorative Parallax Shapes -->
  {%- if show_shapes -%}
    {% render 'decorative-shapes', accent_color: accent_color, text_color: text_color, prefix: 'password' %}
  {%- endif -%}

  <div class="password-container max-w-[600px] w-full mx-auto px-4 sm:px-6 relative z-10">
    <div
      class="password-card {% if background_image != blank %}password-card--glass{% endif %} rounded-2xl p-6 sm:p-8 lg:p-10 animate-on-scroll aos-fade-up"
      style="text-align: {{ heading_alignment }};"
    >
      <!-- Logo (from global theme settings) -->
      <div class="password-logo mb-6 sm:mb-8 animate-on-scroll aos-zoom-in">
        {%- if logo != blank -%}
          <img
            src="{{ logo | image_url: width: logo_width }}"
            srcset="
              {{ logo | image_url: width: 100 }} 100w,
              {{ logo | image_url: width: 150 }} 150w,
              {{ logo | image_url: width: 200 }} 200w,
              {{ logo | image_url: width: 300 }} 300w
            "
            sizes="(max-width: 768px) {{ logo_width | minus: 50 }}px, {{ logo_width }}px"
            alt="{{ shop.name }}"
            class="password-logo-image mx-auto"
            width="{{ logo.width }}"
            height="{{ logo.height }}"
            style="max-width: {{ logo_width }}px; height: auto;"
          >
        {%- else -%}
          <h1 class="password-shop-name text-2xl sm:text-3xl font-bold" style="color: var(--color-text);">
            {{ shop.name }}
          </h1>
        {%- endif -%}
      </div>

      <!-- Heading -->
      {%- if heading != blank -%}
        <h2
          class="password-heading leading-tight mb-4 animate-on-scroll aos-fade-up"
          style="color: {% if background_image != blank %}#ffffff{% else %}var(--color-text){% endif %}; font-weight: var(--password-heading-weight);"
          data-aos-delay="100"
        >
          {{ heading }}
        </h2>
      {%- endif -%}

      <!-- Description -->
      {%- if description != blank -%}
        <p
          class="password-description mb-8 animate-on-scroll aos-fade-up"
          style="color: {% if background_image != blank %}rgba(255, 255, 255, 0.85){% else %}var(--password-muted){% endif %}; font-weight: var(--password-body-weight);"
          data-aos-delay="200"
        >
          {{ description }}
        </p>
      {%- endif -%}

      <!-- Countdown Timer -->
      {%- if show_countdown and countdown_date != blank -%}
        <div
          class="password-countdown mb-8 animate-on-scroll aos-fade-up"
          data-aos-delay="250"
          data-countdown="{{ countdown_date }}"
        >
          <div class="countdown-grid grid grid-cols-4 gap-3 sm:gap-4 max-w-md mx-auto">
            <div class="countdown-item text-center">
              <div
                class="countdown-value text-2xl sm:text-4xl font-bold"
                data-countdown-days
                style="color: {% if background_image != blank %}#ffffff{% else %}var(--color-text){% endif %};"
              >
                00
              </div>
              <div
                class="countdown-label text-xs sm:text-sm mt-1"
                style="color: {% if background_image != blank %}rgba(255, 255, 255, 0.7){% else %}var(--password-muted){% endif %};"
              >
                {{ 'general.password_page.countdown_days' | t | default: 'أيام' }}
              </div>
            </div>
            <div class="countdown-item text-center">
              <div
                class="countdown-value text-2xl sm:text-4xl font-bold"
                data-countdown-hours
                style="color: {% if background_image != blank %}#ffffff{% else %}var(--color-text){% endif %};"
              >
                00
              </div>
              <div
                class="countdown-label text-xs sm:text-sm mt-1"
                style="color: {% if background_image != blank %}rgba(255, 255, 255, 0.7){% else %}var(--password-muted){% endif %};"
              >
                {{ 'general.password_page.countdown_hours' | t | default: 'ساعات' }}
              </div>
            </div>
            <div class="countdown-item text-center">
              <div
                class="countdown-value text-2xl sm:text-4xl font-bold"
                data-countdown-minutes
                style="color: {% if background_image != blank %}#ffffff{% else %}var(--color-text){% endif %};"
              >
                00
              </div>
              <div
                class="countdown-label text-xs sm:text-sm mt-1"
                style="color: {% if background_image != blank %}rgba(255, 255, 255, 0.7){% else %}var(--password-muted){% endif %};"
              >
                {{ 'general.password_page.countdown_minutes' | t | default: 'دقائق' }}
              </div>
            </div>
            <div class="countdown-item text-center">
              <div
                class="countdown-value text-2xl sm:text-4xl font-bold"
                data-countdown-seconds
                style="color: {% if background_image != blank %}#ffffff{% else %}var(--color-text){% endif %};"
              >
                00
              </div>
              <div
                class="countdown-label text-xs sm:text-sm mt-1"
                style="color: {% if background_image != blank %}rgba(255, 255, 255, 0.7){% else %}var(--password-muted){% endif %};"
              >
                {{ 'general.password_page.countdown_seconds' | t | default: 'ثواني' }}
              </div>
            </div>
          </div>
        </div>
      {%- endif -%}

      <!-- Newsletter Form -->
      {%- if show_newsletter -%}
        <div class="password-newsletter mb-6 animate-on-scroll aos-fade-up" data-aos-delay="300">
          {%- if newsletter_heading != blank -%}
            <p
              class="newsletter-heading text-sm mb-3"
              style="color: {% if background_image != blank %}rgba(255, 255, 255, 0.9){% else %}var(--color-text){% endif %};"
            >
              {{ newsletter_heading }}
            </p>
          {%- endif -%}

          {% form 'customer', class: 'password-newsletter-form' %}
            <input type="hidden" name="contact[tags]" value="newsletter,password-page">
            <div class="newsletter-form-wrapper flex flex-col sm:flex-row gap-3">
              <input
                type="email"
                name="contact[email]"
                class="newsletter-input flex-1 {% if background_image != blank %}newsletter-input--glass{% endif %}"
                placeholder="{{ newsletter_placeholder | default: 'أدخل بريدك الإلكتروني' }}"
                required
                autocomplete="email"
              >
              <button
                type="submit"
                class="newsletter-button button--primary"
              >
                {{ newsletter_button_text | default: 'إشترك الآن' }}
              </button>
            </div>
            {%- if form.posted_successfully? -%}
              <p class="newsletter-success text-sm mt-3 flex items-center gap-2" style="color: var(--color-success);">
                <svg
                  class="w-4 h-4 flex-shrink-0"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                  <polyline points="22 4 12 14.01 9 11.01"/>
                </svg>
                {{ 'newsletter.success' | t | default: 'شكراً لاشتراكك!' }}
              </p>
            {%- endif -%}
            {%- if form.errors -%}
              <p class="newsletter-error text-sm mt-3 flex items-center gap-2" style="color: var(--color-error);">
                <svg
                  class="w-4 h-4 flex-shrink-0"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <circle cx="12" cy="12" r="10"/>
                  <line x1="12" y1="8" x2="12" y2="12"/>
                  <line x1="12" y1="16" x2="12.01" y2="16"/>
                </svg>
                {{ form.errors.translated_fields.email | capitalize }}
                {{ form.errors.messages.email }}
              </p>
            {%- endif -%}
          {% endform %}
        </div>
      {%- endif -%}

      <!-- Login Link -->
      {%- if show_login_link -%}
        <div class="password-login mb-6 animate-on-scroll aos-fade-up" data-aos-delay="350">
          <button
            type="button"
            class="password-login-link inline-flex items-center gap-2 text-sm transition-all duration-300 hover:opacity-80"
            data-password-modal-open
            style="color: {% if background_image != blank %}rgba(255, 255, 255, 0.9){% else %}var(--password-accent){% endif %};"
          >
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
            </svg>
            {{ 'general.password_page.login_password_button' | t | default: 'دخول بكلمة المرور' }}
          </button>
        </div>
      {%- endif -%}

      <!-- Social Icons -->
      {%- if show_social -%}
        <div class="password-social animate-on-scroll aos-fade-up" data-aos-delay="400">
          <div class="social-icons flex items-center justify-center gap-4">
            {%- if settings.social_facebook_link != blank -%}
              <a
                href="{{ settings.social_facebook_link }}"
                target="_blank"
                rel="noopener noreferrer"
                class="social-icon transition-all duration-300 hover:scale-110"
                aria-label="Facebook"
                style="color: {% if background_image != blank %}rgba(255, 255, 255, 0.8){% else %}var(--color-accent){% endif %};"
              >
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                </svg>
              </a>
            {%- endif -%}
            {%- if settings.social_instagram_link != blank -%}
              <a
                href="{{ settings.social_instagram_link }}"
                target="_blank"
                rel="noopener noreferrer"
                class="social-icon transition-all duration-300 hover:scale-110"
                aria-label="Instagram"
                style="color: {% if background_image != blank %}rgba(255, 255, 255, 0.8){% else %}var(--color-accent){% endif %};"
              >
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
                </svg>
              </a>
            {%- endif -%}
            {%- if settings.social_twitter_link != blank -%}
              <a
                href="{{ settings.social_twitter_link }}"
                target="_blank"
                rel="noopener noreferrer"
                class="social-icon transition-all duration-300 hover:scale-110"
                aria-label="Twitter/X"
                style="color: {% if background_image != blank %}rgba(255, 255, 255, 0.8){% else %}var(--color-accent){% endif %};"
              >
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                </svg>
              </a>
            {%- endif -%}
            {%- if settings.social_youtube_link != blank -%}
              <a
                href="{{ settings.social_youtube_link }}"
                target="_blank"
                rel="noopener noreferrer"
                class="social-icon transition-all duration-300 hover:scale-110"
                aria-label="YouTube"
                style="color: {% if background_image != blank %}rgba(255, 255, 255, 0.8){% else %}var(--color-accent){% endif %};"
              >
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
                </svg>
              </a>
            {%- endif -%}
            {%- if settings.social_tiktok_link != blank -%}
              <a
                href="{{ settings.social_tiktok_link }}"
                target="_blank"
                rel="noopener noreferrer"
                class="social-icon transition-all duration-300 hover:scale-110"
                aria-label="TikTok"
                style="color: {% if background_image != blank %}rgba(255, 255, 255, 0.8){% else %}var(--color-accent){% endif %};"
              >
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M12.525.02c1.31-.02 2.61-.01 3.91-.02.08 1.53.63 3.09 1.75 4.17 1.12 1.11 2.7 1.62 4.24 1.79v4.03c-1.44-.05-2.89-.35-4.2-.97-.57-.26-1.1-.59-1.62-.93-.01 2.92.01 5.84-.02 8.75-.08 1.4-.54 2.79-1.35 3.94-1.31 1.92-3.58 3.17-5.91 3.21-1.43.08-2.86-.31-4.08-1.03-2.02-1.19-3.44-3.37-3.65-5.71-.02-.5-.03-1-.01-1.49.18-1.9 1.12-3.72 2.58-4.96 1.66-1.44 3.98-2.13 6.15-1.72.02 1.48-.04 2.96-.04 4.44-.99-.32-2.15-.23-3.02.37-.63.41-1.11 1.04-1.36 1.75-.21.51-.15 1.07-.14 1.61.24 1.64 1.82 3.02 3.5 2.87 1.12-.01 2.19-.66 2.77-1.61.19-.33.4-.67.41-1.06.1-1.79.06-3.57.07-5.36.01-4.03-.01-8.05.02-12.07z"/>
                </svg>
              </a>
            {%- endif -%}
            {%- if settings.social_snapchat_link != blank -%}
              <a
                href="{{ settings.social_snapchat_link }}"
                target="_blank"
                rel="noopener noreferrer"
                class="social-icon transition-all duration-300 hover:scale-110"
                aria-label="Snapchat"
                style="color: {% if background_image != blank %}rgba(255, 255, 255, 0.8){% else %}var(--color-accent){% endif %};"
              >
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.217-.937 1.407-5.965 1.407-5.965s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.091.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607 0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026L12.017 0z"/>
                </svg>
              </a>
            {%- endif -%}
            {%- if settings.social_whatsapp_link != blank -%}
              <a
                href="{{ settings.social_whatsapp_link }}"
                target="_blank"
                rel="noopener noreferrer"
                class="social-icon transition-all duration-300 hover:scale-110"
                aria-label="WhatsApp"
                style="color: {% if background_image != blank %}rgba(255, 255, 255, 0.8){% else %}var(--color-accent){% endif %};"
              >
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
                </svg>
              </a>
            {%- endif -%}
            {%- if settings.social_telegram_link != blank -%}
              <a
                href="{{ settings.social_telegram_link }}"
                target="_blank"
                rel="noopener noreferrer"
                class="social-icon transition-all duration-300 hover:scale-110"
                aria-label="Telegram"
                style="color: {% if background_image != blank %}rgba(255, 255, 255, 0.8){% else %}var(--color-accent){% endif %};"
              >
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/>
                </svg>
              </a>
            {%- endif -%}
          </div>
        </div>
      {%- endif -%}
    </div>
  </div>

  <!-- Password Modal -->
  <div
    class="password-modal fixed inset-0 z-50 flex items-center justify-center p-4 opacity-0 pointer-events-none transition-opacity duration-300"
    id="password-modal"
    aria-modal="true"
    role="dialog"
    aria-labelledby="password-modal-title"
  >
    <div class="password-modal-overlay absolute inset-0 bg-black/60" data-password-modal-close></div>
    <div
      class="password-modal-content relative w-full max-w-md rounded-2xl p-6 sm:p-8 transform scale-95 transition-transform duration-300"
      style="background: var(--password-card-bg);"
    >
      <button
        type="button"
        class="password-modal-close absolute top-4 right-4 w-8 h-8 flex items-center justify-center rounded-full transition-all duration-300 hover:bg-gray-100"
        data-password-modal-close
        aria-label="{{ 'accessibility.close' | t }}"
        style="color: var(--password-muted);"
      >
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
        </svg>
      </button>

      <h3 id="password-modal-title" class="text-xl font-bold mb-6" style="color: var(--color-text);">
        {{ 'general.password_page.login_form_heading' | t | default: 'أدخل كلمة المرور' }}
      </h3>

      {% form 'storefront_password', class: 'password-form' %}
        {%- if form.errors -%}
          <div
            class="form-errors p-3 rounded-lg mb-4 flex items-center gap-2"
            style="background: color-mix(in srgb, var(--color-error) 10%, transparent); border: 1px solid color-mix(in srgb, var(--color-error) 30%, transparent); color: var(--color-error);"
          >
            <svg class="w-5 h-5 flex-shrink-0" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <line x1="12" y1="8" x2="12" y2="12"/>
              <line x1="12" y1="16" x2="12.01" y2="16"/>
            </svg>
            <span>{{ form.errors | default_errors }}</span>
          </div>
        {%- endif -%}

        <div class="form-field mb-4">
          <label for="password" class="block text-sm font-medium mb-2" style="color: var(--color-text);">
            {{ 'general.password_page.login_form_password_label' | t | default: 'كلمة المرور' }}
          </label>
          <input
            type="password"
            id="password"
            name="password"
            class="password-input w-full"
            placeholder="{{ 'general.password_page.login_form_password_placeholder' | t | default: 'أدخل كلمة المرور' }}"
            required
            autocomplete="current-password"
          >
        </div>

        <button
          type="submit"
          class="password-submit-btn w-full button--primary"
        >
          {{ 'general.password_page.login_form_submit' | t | default: 'دخول' }}
        </button>
      {% endform %}

      <p class="text-center text-sm mt-6" style="color: var(--password-muted);">
        {{
          'general.password_page.admin_link_html'
          | t
          | default: 'هل أنت صاحب المتجر؟ <a href="/admin" class="underline">سجل دخولك هنا</a>'
        }}
      </p>
    </div>
  </div>
</section>

<style>
  /* ================================
     PASSWORD SECTION BASE STYLES
     ================================ */
  .password-section {
    position: relative;
    min-height: 100vh;
  }

  /* Background */
  .password-background img {
    object-fit: cover;
  }

  /* Typography - Responsive */
  .password-heading {
    font-size: var(--password-heading-desktop);
  }

  .password-description {
    font-size: var(--password-body-desktop);
    line-height: 1.7;
  }

  @media (max-width: 1024px) {
    .password-heading {
      font-size: var(--password-heading-tablet);
    }
    .password-description {
      font-size: var(--password-body-tablet);
    }
  }

  @media (max-width: 768px) {
    .password-heading {
      font-size: var(--password-heading-mobile);
    }
    .password-description {
      font-size: var(--password-body-mobile);
    }
  }

  /* Card Styles */
  .password-card {
    background: var(--password-card-bg);
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.1);
  }

  .password-card--glass {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.2);
  }

  /* Countdown Styles */
  .countdown-item {
    padding: 12px 8px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
  }

  .password-card:not(.password-card--glass) .countdown-item {
    background: var(--password-bg);
    border: 1px solid var(--password-border);
  }

  /* Newsletter Input - Explicitly uses Global Input Settings */
  .newsletter-input {
    /* Ensure border-radius and other properties are from global input settings */
    background-color: var(--input-bg);
    color: var(--input-text);
    border: var(--input-border-thickness) solid var(--input-border);
    border-radius: var(--input-border-radius);
    padding: var(--input-padding-vertical) var(--input-padding-horizontal);
  }

  .newsletter-input:focus {
    border-color: var(--input-focus-border);
    box-shadow: 0 0 0 3px
      color-mix(in srgb, var(--input-focus-shadow) calc(var(--input-focus-shadow-opacity, 0.1) * 100%), transparent);
  }

  /* Fallback for color-mix */
  @supports not (color: color-mix(in srgb, red, blue)) {
    .newsletter-input:focus {
      box-shadow: 0 0 0 3px rgba(26, 39, 68, 0.1);
    }
  }

  /* Glass Style for Newsletter Input (when background image exists) */
  .newsletter-input--glass {
    background: rgba(255, 255, 255, 0.1) !important;
    border-color: rgba(255, 255, 255, 0.3) !important;
    color: #ffffff !important;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
  }

  .newsletter-input--glass::placeholder {
    color: rgba(255, 255, 255, 0.7) !important;
  }

  .newsletter-input--glass:focus {
    border-color: rgba(255, 255, 255, 0.6) !important;
    box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.15) !important;
  }

  /* Newsletter Button - Uses Color Scheme for colors, Global Settings for radius/padding */
  .newsletter-button {
    white-space: nowrap;
    /* Override colors to use color_scheme colors */
    background-color: var(--password-button-bg) !important;
    color: var(--password-button-text) !important;
    border-color: var(--password-button-bg) !important;
    /* Inherit border-radius and padding from global button settings */
    border-radius: var(--button-border-radius);
    padding: var(--button-padding-vertical) var(--button-padding-horizontal);
  }

  .newsletter-button:hover {
    opacity: 0.9;
    filter: brightness(1.1);
  }

  /* Password Modal Input - Explicitly uses Global Input Settings */
  .password-input {
    background-color: var(--input-bg);
    color: var(--input-text);
    border: var(--input-border-thickness) solid var(--input-border);
    border-radius: var(--input-border-radius);
    padding: var(--input-padding-vertical) var(--input-padding-horizontal);
  }

  .password-input:focus {
    border-color: var(--input-focus-border);
    box-shadow: 0 0 0 3px
      color-mix(in srgb, var(--input-focus-shadow) calc(var(--input-focus-shadow-opacity, 0.1) * 100%), transparent);
  }

  /* Fallback for color-mix */
  @supports not (color: color-mix(in srgb, red, blue)) {
    .password-input:focus {
      box-shadow: 0 0 0 3px rgba(26, 39, 68, 0.1);
    }
  }

  /* Password Submit Button - Uses Color Scheme for colors, Global Settings for radius/padding */
  .password-submit-btn {
    /* Override colors to use color_scheme colors */
    background-color: var(--password-button-bg) !important;
    color: var(--password-button-text) !important;
    border-color: var(--password-button-bg) !important;
    /* Inherit border-radius and padding from global button settings */
    border-radius: var(--button-border-radius);
    padding: var(--button-padding-vertical) var(--button-padding-horizontal);
  }

  .password-submit-btn:hover {
    opacity: 0.9;
    filter: brightness(1.1);
  }

  /* Modal Styles */
  .password-modal.is-open {
    opacity: 1;
    pointer-events: auto;
  }

  .password-modal.is-open .password-modal-content {
    transform: scale(1);
  }

  /* ================================
     ANIMATIONS
     ================================ */
  .aos-fade-up {
    opacity: 0;
    transform: translateY(20px);
    animation: aosFadeUp 0.6s ease forwards;
  }

  .aos-zoom-in {
    opacity: 0;
    transform: scale(0.95);
    animation: aosZoomIn 0.6s ease forwards;
  }

  @keyframes aosFadeUp {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes aosZoomIn {
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  /* Animation Delays */
  [data-aos-delay='100'] {
    animation-delay: 0.1s;
  }
  [data-aos-delay='200'] {
    animation-delay: 0.2s;
  }
  [data-aos-delay='250'] {
    animation-delay: 0.25s;
  }
  [data-aos-delay='300'] {
    animation-delay: 0.3s;
  }
  [data-aos-delay='350'] {
    animation-delay: 0.35s;
  }
  [data-aos-delay='400'] {
    animation-delay: 0.4s;
  }

  /* ================================
     REDUCED MOTION
     ================================ */
  @media (prefers-reduced-motion: reduce) {
    .aos-fade-up,
    .aos-zoom-in {
      animation: none;
      opacity: 1;
      transform: none;
    }

    .password-modal,
    .password-modal-content {
      transition: none;
    }
  }
</style>

<script>
  /**
   * Password Section - Modal & Countdown functionality
   * @fileoverview Handles password modal and countdown timer
   * @version 2.0.0
   */
  (function () {
    'use strict';

    /** @constant {string} Modal selectors */
    const MODAL_ID = 'password-modal';
    const MODAL_OPEN_SELECTOR = '[data-password-modal-open]';
    const MODAL_CLOSE_SELECTOR = '[data-password-modal-close]';
    const OPEN_CLASS = 'is-open';

    /** @constant {string} Countdown selector */
    const COUNTDOWN_SELECTOR = '[data-countdown]';

    /**
     * Initialize password section
     * @returns {void}
     */
    function initPasswordSection() {
      initModal();
      initCountdown();
    }

    /**
     * Initialize modal functionality
     */
    function initModal() {
      const modal = document.getElementById(MODAL_ID);
      if (!modal) return;

      // Open modal
      document.addEventListener('click', (e) => {
        const openBtn = e.target.closest(MODAL_OPEN_SELECTOR);
        if (openBtn) {
          e.preventDefault();
          openModal(modal);
        }
      });

      // Close modal
      document.addEventListener('click', (e) => {
        const closeBtn = e.target.closest(MODAL_CLOSE_SELECTOR);
        if (closeBtn) {
          e.preventDefault();
          closeModal(modal);
        }
      });

      // Close on Escape
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && modal.classList.contains(OPEN_CLASS)) {
          closeModal(modal);
        }
      });

      // Check for form errors (auto-open modal)
      const formErrors = modal.querySelector('.form-errors');
      if (formErrors) {
        openModal(modal);
      }
    }

    /**
     * Open modal
     * @param {HTMLElement} modal - Modal element
     */
    function openModal(modal) {
      modal.classList.add(OPEN_CLASS);
      document.body.style.overflow = 'hidden';

      // Focus first input
      const firstInput = modal.querySelector('input');
      if (firstInput) {
        setTimeout(() => firstInput.focus(), 100);
      }
    }

    /**
     * Close modal
     * @param {HTMLElement} modal - Modal element
     */
    function closeModal(modal) {
      modal.classList.remove(OPEN_CLASS);
      document.body.style.overflow = '';
    }

    /**
     * Initialize countdown timer
     */
    function initCountdown() {
      const countdownContainer = document.querySelector(COUNTDOWN_SELECTOR);
      if (!countdownContainer) return;

      const targetDate = new Date(countdownContainer.dataset.countdown).getTime();
      if (isNaN(targetDate)) return;

      const daysEl = countdownContainer.querySelector('[data-countdown-days]');
      const hoursEl = countdownContainer.querySelector('[data-countdown-hours]');
      const minutesEl = countdownContainer.querySelector('[data-countdown-minutes]');
      const secondsEl = countdownContainer.querySelector('[data-countdown-seconds]');

      function updateCountdown() {
        const now = new Date().getTime();
        const distance = targetDate - now;

        if (distance < 0) {
          // Countdown finished
          if (daysEl) daysEl.textContent = '00';
          if (hoursEl) hoursEl.textContent = '00';
          if (minutesEl) minutesEl.textContent = '00';
          if (secondsEl) secondsEl.textContent = '00';
          return;
        }

        const days = Math.floor(distance / (1000 * 60 * 60 * 24));
        const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((distance % (1000 * 60)) / 1000);

        if (daysEl) daysEl.textContent = String(days).padStart(2, '0');
        if (hoursEl) hoursEl.textContent = String(hours).padStart(2, '0');
        if (minutesEl) minutesEl.textContent = String(minutes).padStart(2, '0');
        if (secondsEl) secondsEl.textContent = String(seconds).padStart(2, '0');
      }

      // Update immediately and then every second
      updateCountdown();
      setInterval(updateCountdown, 1000);
    }

    // Initialize on DOM ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initPasswordSection);
    } else {
      initPasswordSection();
    }
  })();
</script>

{% schema %}
{
  "name": "t:sections.main_password.name",
  "tag": "section",
  "class": "section-main-password",
  "settings": [
    {
      "type": "header",
      "content": "t:sections.main_password.settings.header.content"
    },
    {
      "type": "paragraph",
      "content": "t:sections.main_password.settings.paragraph.content"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "t:sections.main_password.settings.heading.label",
      "default": "قريباً... نعمل على شيء مميز!"
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "t:sections.main_password.settings.description.label",
      "default": "نعمل جاهدين لإطلاق متجرنا الجديد. اشترك في القائمة البريدية ليصلك إشعار فور الإطلاق!"
    },
    {
      "type": "select",
      "id": "heading_alignment",
      "label": "t:sections.main_password.settings.heading_alignment.label",
      "default": "center",
      "options": [
        {
          "value": "right",
          "label": "t:sections.main_password.settings.heading_alignment.options.right"
        },
        {
          "value": "center",
          "label": "t:sections.main_password.settings.heading_alignment.options.center"
        },
        {
          "value": "left",
          "label": "t:sections.main_password.settings.heading_alignment.options.left"
        }
      ]
    },
    {
      "type": "header",
      "content": "t:sections.main_password.settings.header.content"
    },
    {
      "type": "checkbox",
      "id": "show_countdown",
      "label": "t:sections.main_password.settings.show_countdown.label",
      "default": true
    },
    {
      "type": "text",
      "id": "countdown_date",
      "label": "t:sections.main_password.settings.countdown_date.label",
      "default": "2026-02-01T00:00:00",
      "info": "t:sections.main_password.settings.countdown_date.info"
    },
    {
      "type": "header",
      "content": "t:sections.main_password.settings.header.content"
    },
    {
      "type": "checkbox",
      "id": "show_newsletter",
      "label": "t:sections.main_password.settings.show_newsletter.label",
      "default": true
    },
    {
      "type": "text",
      "id": "newsletter_heading",
      "label": "t:sections.main_password.settings.newsletter_heading.label",
      "default": "كن أول من يعلم عند الإطلاق:"
    },
    {
      "type": "text",
      "id": "newsletter_placeholder",
      "label": "t:sections.main_password.settings.newsletter_placeholder.label",
      "default": "أدخل بريدك الإلكتروني"
    },
    {
      "type": "text",
      "id": "newsletter_button_text",
      "label": "t:sections.main_password.settings.newsletter_button_text.label",
      "default": "إشترك الآن"
    },
    {
      "type": "header",
      "content": "t:sections.main_password.settings.header.content"
    },
    {
      "type": "checkbox",
      "id": "show_login_link",
      "label": "t:sections.main_password.settings.show_login_link.label",
      "default": true
    },
    {
      "type": "header",
      "content": "t:sections.main_password.settings.header.content"
    },
    {
      "type": "checkbox",
      "id": "show_social",
      "label": "t:sections.main_password.settings.show_social.label",
      "default": true,
      "info": "t:sections.main_password.settings.show_social.info"
    },
    {
      "type": "header",
      "content": "t:sections.main_password.settings.header.content"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:sections.main_password.settings.color_scheme.label",
      "default": "scheme-1"
    },
    {
      "type": "header",
      "content": "t:sections.main_password.settings.header.content"
    },
    {
      "type": "checkbox",
      "id": "show_shapes",
      "label": "t:sections.main_password.settings.show_shapes.label",
      "default": false,
      "info": "t:sections.main_password.settings.show_shapes.info"
    },
    {
      "type": "header",
      "content": "t:sections.main_password.settings.header.content"
    },
    {
      "type": "image_picker",
      "id": "background_image",
      "label": "t:sections.main_password.settings.background_image.label",
      "info": "t:sections.main_password.settings.background_image.info"
    },
    {
      "type": "range",
      "id": "background_overlay_opacity",
      "label": "t:sections.main_password.settings.background_overlay_opacity.label",
      "default": 50,
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "%",
      "info": "t:sections.main_password.settings.background_overlay_opacity.info"
    },
    {
      "type": "header",
      "content": "t:sections.main_password.settings.header.content"
    },
    {
      "type": "range",
      "id": "heading_size_desktop",
      "label": "t:sections.main_password.settings.heading_size_desktop.label",
      "default": 48,
      "min": 32,
      "max": 72,
      "step": 2,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "body_size_desktop",
      "label": "t:sections.main_password.settings.body_size_desktop.label",
      "default": 18,
      "min": 14,
      "max": 24,
      "step": 1,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "t:sections.main_password.settings.header.content"
    },
    {
      "type": "range",
      "id": "heading_size_tablet",
      "label": "t:sections.main_password.settings.heading_size_tablet.label",
      "default": 40,
      "min": 24,
      "max": 60,
      "step": 2,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "body_size_tablet",
      "label": "t:sections.main_password.settings.body_size_tablet.label",
      "default": 16,
      "min": 12,
      "max": 20,
      "step": 1,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "t:sections.main_password.settings.header.content"
    },
    {
      "type": "range",
      "id": "heading_size_mobile",
      "label": "t:sections.main_password.settings.heading_size_mobile.label",
      "default": 32,
      "min": 20,
      "max": 48,
      "step": 2,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "body_size_mobile",
      "label": "t:sections.main_password.settings.body_size_mobile.label",
      "default": 14,
      "min": 12,
      "max": 18,
      "step": 1,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "t:sections.main_password.settings.header.content"
    },
    {
      "type": "select",
      "id": "heading_weight",
      "label": "t:sections.main_password.settings.heading_weight.label",
      "default": "700",
      "options": [
        {
          "value": "400",
          "label": "t:sections.main_password.settings.heading_weight.options.400"
        },
        {
          "value": "500",
          "label": "t:sections.main_password.settings.heading_weight.options.500"
        },
        {
          "value": "600",
          "label": "t:sections.main_password.settings.heading_weight.options.600"
        },
        {
          "value": "700",
          "label": "t:sections.main_password.settings.heading_weight.options.700"
        },
        {
          "value": "800",
          "label": "t:sections.main_password.settings.heading_weight.options.800"
        }
      ]
    },
    {
      "type": "select",
      "id": "body_weight",
      "label": "t:sections.main_password.settings.body_weight.label",
      "default": "400",
      "options": [
        {
          "value": "400",
          "label": "t:sections.main_password.settings.body_weight.options.400"
        },
        {
          "value": "500",
          "label": "t:sections.main_password.settings.body_weight.options.500"
        },
        {
          "value": "600",
          "label": "t:sections.main_password.settings.body_weight.options.600"
        }
      ]
    },
    {
      "type": "header",
      "content": "t:sections.main_password.settings.header.content"
    },
    {
      "type": "range",
      "id": "padding_top",
      "label": "t:sections.main_password.settings.padding_top.label",
      "default": 60,
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "label": "t:sections.main_password.settings.padding_bottom.label",
      "default": 60,
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px"
    }
  ]
}
{% endschema %}
