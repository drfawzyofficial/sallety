{%- comment -%}
  Sallety Theme - Google Maps Section
  Professional Google Maps integration with full customization
  RTL/Arabic support with color scheme integration
{%- endcomment -%}

{%- liquid
  # Color scheme class (uses CSS classes from theme.liquid)
  assign scheme_number = section.settings.color_scheme.id | remove: 'scheme-'
  
  # Typography weights
  assign heading_weight = section.settings.heading_weight | default: '700'
  assign content_weight = section.settings.content_weight | default: '400'
  
  # Section settings
  assign show_heading = section.settings.show_heading
  assign section_heading = section.settings.heading
  assign section_subheading = section.settings.subheading
  assign section_content = section.settings.content
  assign content_alignment = section.settings.content_alignment | default: 'center'
  
  # Map settings
  assign map_embed_url = section.settings.map_embed_url
  assign map_address = section.settings.address
  assign map_height_desktop = section.settings.map_height_desktop | default: 450
  assign map_height_mobile = section.settings.map_height_mobile | default: 300
  assign map_border_radius = section.settings.map_border_radius | default: 16
  assign map_shadow = section.settings.map_shadow
  assign map_zoom = section.settings.map_zoom | default: 14
  
  # Layout settings
  assign full_width = section.settings.full_width
  assign layout_style = section.settings.layout_style | default: 'stacked'
  assign content_position = section.settings.content_position | default: 'above'
  assign content_width = section.settings.content_width | default: '50'
  
  # Decorative settings
  assign show_decorations = section.settings.show_decorations
  assign show_location_icon = section.settings.show_location_icon
  
  # Padding
  assign padding_top = section.settings.padding_top | default: 60
  assign padding_bottom = section.settings.padding_bottom | default: 60
-%}

<section 
  class="google-maps-section color-scheme-{{ scheme_number }} relative overflow-hidden"
  data-section-id="{{ section.id }}"
  data-section-type="google-maps"
  style="
    --gmap-heading-weight: {{ heading_weight }};
    --gmap-content-weight: {{ content_weight }};
    --gmap-height-desktop: {{ map_height_desktop }}px;
    --gmap-height-mobile: {{ map_height_mobile }}px;
    --gmap-border-radius: {{ map_border_radius }}px;
    --gmap-padding-top: {{ padding_top }}px;
    --gmap-padding-bottom: {{ padding_bottom }}px;
    padding-top: var(--gmap-padding-top);
    padding-bottom: var(--gmap-padding-bottom);
    font-family: var(--font-body-family);
  "
>
  {%- comment -%} Decorative Background Shapes {%- endcomment -%}
  {%- if show_decorations -%}
    <div class="gmap-decorations" aria-hidden="true">
      <div class="gmap-decoration gmap-decoration-1"></div>
      <div class="gmap-decoration gmap-decoration-2"></div>
      <div class="gmap-decoration gmap-decoration-3"></div>
    </div>
  {%- endif -%}

  <div class="{% if full_width %}container-fluid{% else %}container{% endif %} relative z-10">
    
    {%- comment -%} Side by Side Layout {%- endcomment -%}
    {%- if layout_style == 'side_by_side' -%}
      <div class="gmap-grid gmap-grid--side-by-side {% if content_position == 'right' %}gmap-grid--reverse{% endif %}">
        {%- comment -%} Content Column {%- endcomment -%}
        <div class="gmap-content-column" style="--gmap-content-width: {{ content_width }}%;">
          {%- render 'google-maps-content',
            show_heading: show_heading,
            section_heading: section_heading,
            section_subheading: section_subheading,
            section_content: section_content,
            content_alignment: content_alignment,
            show_location_icon: show_location_icon,
            map_address: map_address
          -%}
        </div>
        
        {%- comment -%} Map Column {%- endcomment -%}
        <div class="gmap-map-column">
          {%- render 'google-maps-embed',
            map_embed_url: map_embed_url,
            map_address: map_address,
            map_zoom: map_zoom,
            map_shadow: map_shadow,
            map_border_radius: map_border_radius
          -%}
        </div>
      </div>
    
    {%- comment -%} Stacked Layout {%- endcomment -%}
    {%- else -%}
      {%- comment -%} Content Above Map {%- endcomment -%}
      {%- if content_position == 'above' -%}
        <div class="gmap-content-wrapper text-{{ content_alignment }}">
          {%- render 'google-maps-content',
            show_heading: show_heading,
            section_heading: section_heading,
            section_subheading: section_subheading,
            section_content: section_content,
            content_alignment: content_alignment,
            show_location_icon: show_location_icon,
            map_address: map_address
          -%}
        </div>
        
        <div class="gmap-map-wrapper">
          {%- render 'google-maps-embed',
            map_embed_url: map_embed_url,
            map_address: map_address,
            map_zoom: map_zoom,
            map_shadow: map_shadow,
            map_border_radius: map_border_radius
          -%}
        </div>
      
      {%- comment -%} Content Below Map {%- endcomment -%}
      {%- else -%}
        <div class="gmap-map-wrapper gmap-map-wrapper--above">
          {%- render 'google-maps-embed',
            map_embed_url: map_embed_url,
            map_address: map_address,
            map_zoom: map_zoom,
            map_shadow: map_shadow,
            map_border_radius: map_border_radius
          -%}
        </div>
        
        <div class="gmap-content-wrapper text-{{ content_alignment }}">
          {%- render 'google-maps-content',
            show_heading: show_heading,
            section_heading: section_heading,
            section_subheading: section_subheading,
            section_content: section_content,
            content_alignment: content_alignment,
            show_location_icon: show_location_icon,
            map_address: map_address
          -%}
        </div>
      {%- endif -%}
    {%- endif -%}
    
  </div>
</section>

<style>
  /* ================================
     GOOGLE MAPS SECTION STYLES
     ================================ */
  
  .google-maps-section {
    position: relative;
  }
  
  /* Container overrides for full width */
  .google-maps-section .container {
    max-width: var(--page-width);
    margin-inline: auto;
    padding-inline: var(--container-padding, 20px);
  }
  
  .google-maps-section .container-fluid {
    width: 100%;
    padding-inline: var(--container-padding, 20px);
  }
  
  /* ================================
     CONTENT WRAPPER
     ================================ */
  
  .gmap-content-wrapper {
    margin-bottom: 2rem;
  }
  
  .gmap-content-wrapper--below {
    margin-bottom: 0;
    margin-top: 2rem;
  }
  
  .gmap-map-wrapper--above {
    margin-bottom: 2rem;
  }
  
  /* Content alignment */
  .gmap-content-wrapper.text-center {
    text-align: center;
  }
  
  .gmap-content-wrapper.text-start {
    text-align: start;
  }
  
  .gmap-content-wrapper.text-end {
    text-align: end;
  }
  
  /* Heading styles */
  .gmap-heading {
    font-size: var(--font-heading-size);
    font-weight: var(--gmap-heading-weight);
    color: var(--color-text);
    margin: 0 0 0.5rem 0;
    line-height: 1.3;
  }
  
  .gmap-subheading {
    font-size: calc(var(--font-body-size) * 1.1);
    font-weight: var(--gmap-content-weight);
    color: var(--color-secondary-text);
    margin: 0 0 1rem 0;
    line-height: 1.5;
  }
  
  .gmap-description {
    font-size: var(--font-body-size);
    font-weight: var(--gmap-content-weight);
    color: var(--color-secondary-text);
    line-height: 1.7;
    max-width: 700px;
  }
  
  .gmap-content-wrapper.text-center .gmap-description {
    margin-inline: auto;
  }
  
  .gmap-description p {
    margin: 0 0 0.75rem 0;
  }
  
  .gmap-description p:last-child {
    margin-bottom: 0;
  }
  
  /* Location icon and address */
  .gmap-location-info {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    margin-top: 1rem;
    padding: 0.75rem 1.25rem;
    background: var(--color-card-background);
    border-radius: 8px;
    border: 1px solid var(--color-border);
  }
  
  .gmap-location-icon {
    width: 20px;
    height: 20px;
    color: var(--color-text);
    flex-shrink: 0;
  }
  
  .gmap-location-address {
    font-size: calc(var(--font-body-size) * 0.9);
    color: var(--color-secondary-text);
    margin: 0;
  }
  
  /* ================================
     MAP CONTAINER
     ================================ */
  
  .gmap-map-container {
    position: relative;
    width: 100%;
    height: var(--gmap-height-desktop);
    border-radius: var(--gmap-border-radius);
    overflow: hidden;
    background: var(--color-card-background);
  }
  
  .gmap-map-container--shadow {
    box-shadow: 
      0 4px 20px rgba(0, 0, 0, 0.1),
      0 8px 32px rgba(0, 0, 0, 0.08);
  }
  
  .gmap-map-container iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: 0;
  }
  
  /* Map placeholder */
  .gmap-placeholder {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100%;
    padding: 2rem;
    text-align: center;
    background: var(--color-card-background);
    border: 2px dashed var(--color-border);
    border-radius: var(--gmap-border-radius);
  }
  
  .gmap-placeholder-icon {
    width: 48px;
    height: 48px;
    margin-bottom: 1rem;
    color: var(--color-secondary-text);
    opacity: 0.6;
  }
  
  .gmap-placeholder-text {
    font-size: var(--font-body-size);
    color: var(--color-secondary-text);
    margin: 0;
  }
  
  /* ================================
     SIDE BY SIDE LAYOUT
     ================================ */
  
  .gmap-grid--side-by-side {
    display: grid;
    grid-template-columns: var(--gmap-content-width, 50%) 1fr;
    gap: 2rem;
    align-items: center;
  }
  
  .gmap-grid--side-by-side.gmap-grid--reverse {
    grid-template-columns: 1fr var(--gmap-content-width, 50%);
  }
  
  .gmap-grid--side-by-side.gmap-grid--reverse .gmap-content-column {
    order: 2;
  }
  
  .gmap-grid--side-by-side.gmap-grid--reverse .gmap-map-column {
    order: 1;
  }
  
  .gmap-content-column {
    padding-inline-end: 1rem;
  }
  
  .gmap-grid--reverse .gmap-content-column {
    padding-inline-end: 0;
    padding-inline-start: 1rem;
  }
  
  /* ================================
     DECORATIVE SHAPES
     ================================ */
  
  .gmap-decorations {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    pointer-events: none;
    z-index: 1;
    overflow: hidden;
  }
  
  .gmap-decoration {
    position: absolute;
    opacity: 0.06;
    background: var(--color-text);
  }
  
  .gmap-decoration-1 {
    width: 200px;
    height: 200px;
    top: -50px;
    right: -50px;
    border-radius: 50%;
    animation: gmap-float-1 15s ease-in-out infinite;
  }
  
  .gmap-decoration-2 {
    width: 100px;
    height: 100px;
    bottom: 20%;
    left: 5%;
    border-radius: 50%;
    animation: gmap-float-2 12s ease-in-out infinite;
  }
  
  .gmap-decoration-3 {
    width: 60px;
    height: 60px;
    top: 30%;
    left: 15%;
    transform: rotate(45deg);
    animation: gmap-pulse 8s ease-in-out infinite;
  }
  
  @keyframes gmap-float-1 {
    0%, 100% { transform: translate(0, 0) scale(1); }
    50% { transform: translate(-20px, 20px) scale(1.05); }
  }
  
  @keyframes gmap-float-2 {
    0%, 100% { transform: translate(0, 0); }
    50% { transform: translate(15px, -10px); }
  }
  
  @keyframes gmap-pulse {
    0%, 100% { transform: rotate(45deg) scale(1); opacity: 0.06; }
    50% { transform: rotate(45deg) scale(1.2); opacity: 0.1; }
  }
  
  /* ================================
     RESPONSIVE STYLES
     ================================ */
  
  /* Tablet */
  @media (max-width: 1024px) {
    .gmap-grid--side-by-side {
      grid-template-columns: 1fr;
      gap: 1.5rem;
    }
    
    .gmap-grid--side-by-side.gmap-grid--reverse {
      grid-template-columns: 1fr;
    }
    
    .gmap-grid--side-by-side .gmap-content-column,
    .gmap-grid--side-by-side .gmap-map-column {
      order: unset;
    }
    
    .gmap-content-column {
      padding-inline: 0;
    }
    
    .gmap-grid--reverse .gmap-content-column {
      padding-inline: 0;
    }
    
    .gmap-decoration-1 {
      width: 150px;
      height: 150px;
    }
    
    .gmap-decoration-2 {
      width: 70px;
      height: 70px;
    }
  }
  
  /* Mobile */
  @media (max-width: 768px) {
    .gmap-map-container {
      height: var(--gmap-height-mobile);
    }
    
    .gmap-content-wrapper {
      margin-bottom: 1.5rem;
    }
    
    .gmap-heading {
      font-size: var(--font-heading-size-mobile, calc(var(--font-heading-size) * 0.85));
    }
    
    .gmap-location-info {
      padding: 0.5rem 1rem;
    }
    
    .gmap-decoration-1 {
      width: 100px;
      height: 100px;
      top: -30px;
      right: -30px;
    }
    
    .gmap-decoration-2,
    .gmap-decoration-3 {
      display: none;
    }
  }
  
  /* Extra small */
  @media (max-width: 480px) {
    .gmap-location-info {
      flex-direction: column;
      text-align: center;
      gap: 0.25rem;
    }
  }
  
  /* ================================
     REDUCED MOTION
     ================================ */
  
  @media (prefers-reduced-motion: reduce) {
    .gmap-decoration {
      animation: none !important;
    }
  }
</style>

{% schema %}
{
  "name": "t:sections.google_maps.name",
  "tag": "section",
  "class": "section-google-maps",
  "settings": [
    {
      "type": "header",
      "content": "t:sections.google_maps.settings.content.header"
    },
    {
      "type": "checkbox",
      "id": "show_heading",
      "label": "t:sections.google_maps.settings.show_heading.label",
      "default": true
    },
    {
      "type": "text",
      "id": "heading",
      "label": "t:sections.google_maps.settings.heading.label",
      "default": "شرفنا بزيارتك"
    },
    {
      "type": "text",
      "id": "subheading",
      "label": "t:sections.google_maps.settings.subheading.label",
      "default": "متواجدين لخدمتك طوال أيام الأسبوع من الساعة 8 ص الى 11 م"
    },
    {
      "type": "richtext",
      "id": "content",
      "label": "t:sections.google_maps.settings.content.label"
    },
    {
      "type": "select",
      "id": "content_alignment",
      "label": "t:sections.google_maps.settings.content_alignment.label",
      "default": "center",
      "options": [
        { "value": "start", "label": "t:sections.google_maps.settings.content_alignment.options.start" },
        { "value": "center", "label": "t:sections.google_maps.settings.content_alignment.options.center" },
        { "value": "end", "label": "t:sections.google_maps.settings.content_alignment.options.end" }
      ]
    },
    {
      "type": "header",
      "content": "t:sections.google_maps.settings.map.header"
    },
    {
      "type": "text",
      "id": "map_embed_url",
      "label": "t:sections.google_maps.settings.map_embed_url.label",
      "info": "t:sections.google_maps.settings.map_embed_url.info"
    },
    {
      "type": "text",
      "id": "address",
      "label": "t:sections.google_maps.settings.address.label",
      "default": "الرياض، المملكة العربية السعودية",
      "info": "t:sections.google_maps.settings.address.info"
    },
    {
      "type": "range",
      "id": "map_zoom",
      "label": "t:sections.google_maps.settings.map_zoom.label",
      "default": 14,
      "min": 10,
      "max": 20,
      "step": 1
    },
    {
      "type": "range",
      "id": "map_height_desktop",
      "label": "t:sections.google_maps.settings.map_height_desktop.label",
      "default": 450,
      "min": 300,
      "max": 700,
      "step": 10,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "map_height_mobile",
      "label": "t:sections.google_maps.settings.map_height_mobile.label",
      "default": 300,
      "min": 200,
      "max": 500,
      "step": 10,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "map_border_radius",
      "label": "t:sections.google_maps.settings.map_border_radius.label",
      "default": 16,
      "min": 0,
      "max": 40,
      "step": 2,
      "unit": "px"
    },
    {
      "type": "checkbox",
      "id": "map_shadow",
      "label": "t:sections.google_maps.settings.map_shadow.label",
      "default": true
    },
    {
      "type": "header",
      "content": "t:sections.google_maps.settings.layout.header"
    },
    {
      "type": "checkbox",
      "id": "full_width",
      "label": "t:sections.google_maps.settings.full_width.label",
      "default": false
    },
    {
      "type": "select",
      "id": "layout_style",
      "label": "t:sections.google_maps.settings.layout_style.label",
      "default": "stacked",
      "options": [
        { "value": "stacked", "label": "t:sections.google_maps.settings.layout_style.options.stacked" },
        { "value": "side_by_side", "label": "t:sections.google_maps.settings.layout_style.options.side_by_side" }
      ]
    },
    {
      "type": "select",
      "id": "content_position",
      "label": "t:sections.google_maps.settings.content_position.label",
      "default": "above",
      "options": [
        { "value": "above", "label": "t:sections.google_maps.settings.content_position.options.above" },
        { "value": "below", "label": "t:sections.google_maps.settings.content_position.options.below" },
        { "value": "left", "label": "t:sections.google_maps.settings.content_position.options.left" },
        { "value": "right", "label": "t:sections.google_maps.settings.content_position.options.right" }
      ]
    },
    {
      "type": "range",
      "id": "content_width",
      "label": "t:sections.google_maps.settings.content_width.label",
      "default": 50,
      "min": 30,
      "max": 60,
      "step": 5,
      "unit": "%",
      "info": "t:sections.google_maps.settings.content_width.info"
    },
    {
      "type": "header",
      "content": "t:sections.google_maps.settings.decoration.header"
    },
    {
      "type": "checkbox",
      "id": "show_decorations",
      "label": "t:sections.google_maps.settings.show_decorations.label",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "show_location_icon",
      "label": "t:sections.google_maps.settings.show_location_icon.label",
      "default": false
    },
    {
      "type": "header",
      "content": "t:sections.google_maps.settings.colors.header"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:sections.all.colors.label",
      "default": "scheme-1"
    },
    {
      "type": "header",
      "content": "t:sections.google_maps.settings.typography.header"
    },
    {
      "type": "select",
      "id": "heading_weight",
      "label": "t:sections.google_maps.settings.heading_weight.label",
      "default": "700",
      "options": [
        { "value": "400", "label": "t:sections.google_maps.settings.font_weight.options.regular" },
        { "value": "500", "label": "t:sections.google_maps.settings.font_weight.options.medium" },
        { "value": "600", "label": "t:sections.google_maps.settings.font_weight.options.semibold" },
        { "value": "700", "label": "t:sections.google_maps.settings.font_weight.options.bold" }
      ]
    },
    {
      "type": "select",
      "id": "content_weight",
      "label": "t:sections.google_maps.settings.content_weight.label",
      "default": "400",
      "options": [
        { "value": "400", "label": "t:sections.google_maps.settings.font_weight.options.regular" },
        { "value": "500", "label": "t:sections.google_maps.settings.font_weight.options.medium" },
        { "value": "600", "label": "t:sections.google_maps.settings.font_weight.options.semibold" }
      ]
    },
    {
      "type": "header",
      "content": "t:sections.all.padding.section_padding_heading"
    },
    {
      "type": "range",
      "id": "padding_top",
      "label": "t:sections.all.padding.padding_top",
      "default": 60,
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "label": "t:sections.all.padding.padding_bottom",
      "default": 60,
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px"
    }
  ],
  "presets": [
    {
      "name": "t:sections.google_maps.presets.name",
      "settings": {
        "heading": "شرفنا بزيارتك",
        "subheading": "متواجدين لخدمتك طوال أيام الأسبوع من الساعة 8 ص الى 11 م",
        "address": "الرياض، المملكة العربية السعودية",
        "map_height_desktop": 450,
        "map_height_mobile": 300,
        "map_border_radius": 16,
        "map_shadow": true,
        "content_alignment": "center",
        "layout_style": "stacked",
        "content_position": "above"
      }
    }
  ]
}
{% endschema %}

